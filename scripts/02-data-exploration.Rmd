---
title: "First Exploration"
output: 
  html_document:
    theme: paper
date: "`r Sys.Date()`"
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load packages

```{r message=FALSE, warning=FALSE}
pacman::p_load(modelsummary, pwr, survey, broom, dplyr, tidyr, knitr, kableExtra, gt,
               rstatix, ggeffects, ggplot2, gridExtra, magrittr)
```

<br>

# Open data

```{r}
load("/Users/franciscacastro/Dropbox/Shared_ERC_Francisca_and_Jenny/r-project/environment.Rdata")
#load("C:/Users/Francisca/Dropbox/Shared_ERC_Francisca_and_Jenny/r-project/environment.Rdata")
```

<br>

# Data exploration

Mean demographic values by treatment assignment of the following
variables:

-   `race`: 1 = white

-   `gender4`: 1 = male

-   `BGU_knowledge1` to `BGU_knowledge6` for political knowledge

-   `BGU_Trumpapproval`: from 1 = strongly approve to 5 = strongly
    disapprove

-   `CC21_330a` ideology from 1 = very liberal to 7 = very conservative

-   `pid3` party identification with the following categories: 1 =
    democrat 2 = republican 3 = independent

-   `faminc_new`

-   `educ`

```{r}
summary_stats <- data_raw %>%
  group_by(BGU_group) %>%
  summarize(
    mean_race_white = round(mean(race == 1, na.rm = TRUE), 2),
    mean_gender_male = round(mean(gender4 == 1, na.rm = TRUE), 2),
    mean_trump_approve = round(mean(BGU_Trumpapproval %in% c(1, 2), na.rm = TRUE), 2), # strongly and somewhat approve
    mean_ideology = round(mean(ifelse(CC21_330a %in% 1:7, CC21_330a, NA), na.rm = TRUE), 2), # excluding 8 Not sure
    mean_party_dem = round(mean(pid3 == 1, na.rm = TRUE), 2), #democrat
    mean_party_rep = round(mean(pid3 == 2, na.rm = TRUE), 2), #republican
    mean_faminc = round(mean(faminc_new, na.rm = TRUE), 2),
    mean_educ = round(mean(educ, na.rm = TRUE), 2))

# Transform to wide format to make the table

summary_stats_wide <- summary_stats %>%
  pivot_longer(cols = -BGU_group,
               names_to = "metric",
               values_to = "value") %>%
  pivot_wider(names_from = BGU_group,
              values_from = value) %>%
  mutate(metric = c("White", "Male", "Trump Approval", "Ideology", "Democrat", 
                    "Republican", "Income", "Education")) %>%
  rename("Variable" = 1,
         "Control" = 2,
         "Trump Liberal" = 3,
         "Trump Conservative" = 4,
         "Close Friend Liberal" = 5,
         "Close Friend Conservative" = 6)


table <- summary_stats_wide %>%
  kable("html", booktabs = TRUE) %>%
  kable_styling(full_width = FALSE, position = "center") %>%
  column_spec(1:ncol(summary_stats_wide), width = "4cm")

table_latex <- summary_stats_wide %>%
  kable("latex", booktabs = TRUE) %>%
  kable_styling(full_width = FALSE, position = "center") %>%
  column_spec(1:ncol(summary_stats_wide), width = "3cm")

table
```

<br>

# Preliminary analyses

## With long database

Assessing the effect of the treatment on policy positions.

```{r}
models_initial <- list(
  "Initial Model" = lm(policy_opinion ~ libtrump + contrump + libfriend + confriend, data = data_long))


msummary(models_initial,
         stars = c('*' = .1, '**' = .05, '***' = .01))
```

## With wide database

Assessing the effect of the treatment on policy positions *for each
topic*.

```{r}
models_initial_w <- list(
  "Wages" = lm(minimum_wage ~ BGU_group, data = data_wide),
  "Taxes" = lm(taxes ~ BGU_group, data = data_wide),
  "Abortion" = lm(abortion ~ BGU_group, data = data_wide),
  "Immigration" = lm(immigration ~ BGU_group, data = data_wide),
  "Guns" = lm(guns ~ BGU_group, data = data_wide),
  "Health Care" = lm(health ~ BGU_group, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group, data = data_wide),
  "Planned Parenthood" = lm(p_parent ~ BGU_group, data = data_wide))


msummary(models_initial_w,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = 'markdown')
```

Filtered results for the paper

```{r}
models_filtered <- list(
  "Immigration" = lm(immigration ~ BGU_group, data = data_wide),
  "Background \n Checks" = lm(b_checks ~ BGU_group, data = data_wide))


msummary(models_filtered,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = "markdown")
```

# Interactions

Interactions between:

-   Treatment (close friend) and political knowledge $\rightarrow$
    `knowledge_index`

-   Treatment (close friend) and ideology $\rightarrow$ `ideology` and
    `party_id`

-   Treatment (close friend) and social conformism (when they value
    conformity over autonomy in how they think and behave) $\rightarrow$
    `SCI`

## Political knowledge

```{r}
pol_knowledge_interaction <- list(
  "Wages" = lm(minimum_wage ~ BGU_group * knowledge_index, data = data_wide),
  "Taxes" = lm(taxes ~ BGU_group * knowledge_index, data = data_wide),
  "Abortion" = lm(abortion ~ BGU_group * knowledge_index, data = data_wide),
  "Immigration" = lm(immigration ~ BGU_group * knowledge_index, data = data_wide),
  "Guns" = lm(guns ~ BGU_group * knowledge_index, data = data_wide),
  "Health Care" = lm(health ~ BGU_group * knowledge_index, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group * knowledge_index, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group * knowledge_index, data = data_wide),
  "Planned Parenthood" = lm(p_parent ~ BGU_group * knowledge_index, data = data_wide)
)

pol_knowledge_interaction_sig <- list(
  "Guns" = lm(guns ~ BGU_group * knowledge_index, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group * knowledge_index, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group * knowledge_index, data = data_wide)
)

msummary(pol_knowledge_interaction_sig,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = 'markdown')
```
### Relevant interactions: Guns

```{r}
model_pk_guns <- lm(guns ~ BGU_group * knowledge_index, data = data_wide)
effects_TL_pk_guns <- ggpredict(model_pk_guns, terms = c("knowledge_index", "BGU_group[TL]"))
effects_TC_pk_guns <- ggpredict(model_pk_guns, terms = c("knowledge_index", "BGU_group[TC]"))
effects_CFL_pk_guns <- ggpredict(model_pk_guns, terms = c("knowledge_index", "BGU_group[CFL]"))
effects_CFC_pk_guns <- ggpredict(model_pk_guns, terms = c("knowledge_index", "BGU_group[CFC]"))

effects_pk_guns <- rbind(transform(effects_TL_pk_guns, treatment = "TL"),
                      transform(effects_TC_pk_guns, treatment = "TC"),
                      transform(effects_CFL_pk_guns, treatment = "CFL"),
                      transform(effects_CFC_pk_guns, treatment = "CFC"))

effects_pk_guns$treatment <- factor(effects_pk_guns$treatment, 
                                    levels = c("TL", "TC", "CFL", "CFC"), 
                                    labels = c("Trump Liberal", "Trump Conservative",
                                               "CF Liberal", "CF Conservative"))

# Subset the data for Trump 
trump_effects_pk_guns <- subset(effects_pk_guns, treatment %in% c("Trump Liberal", "Trump Conservative"))

# Subset the data for Close Friend 
cf_effects_pk_guns <- subset(effects_pk_guns, treatment %in% c("CF Liberal", "CF Conservative"))

# Plot for Trump treatments
guns_plot_pk_trump <- ggplot(trump_effects_pk_guns, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Guns Policy Position", title = "Trump Treatments",
       x = "Political Knowledge",  color = "Treatment", fill = "Treatment") +
  theme_minimal() +
  theme(legend.position = "none")+
  scale_color_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

guns_plot_pk_trump

# Plot for Close Friend treatments
guns_plot_pk_cf <- ggplot(cf_effects_pk_guns, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Guns Policy Position", title = "Close Friend Treatments",
       x = "Political Knowledge", color = " ", fill = " ") +
  theme_minimal() +
  theme(legend.position = "none", axis.title.y = element_blank())  +
  scale_color_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

guns_plot_pk_cf

guns_plot_pk_final <- grid.arrange(guns_plot_pk_trump, guns_plot_pk_cf, ncol = 2, widths = c(1.1, 1.0)) 

ggsave("guns_plot_polknowledge.png", guns_plot_pk_final, width = 6, height = 5, dpi = 600)
```


### Relevant interactions: Background checks

```{r}
model_pk_bchecks <- lm(b_checks ~ BGU_group * knowledge_index, data = data_wide)
effects_TL_pk_bchecks <- ggpredict(model_pk_bchecks, terms = c("knowledge_index", "BGU_group[TL]"))
effects_TC_pk_bchecks <- ggpredict(model_pk_bchecks, terms = c("knowledge_index", "BGU_group[TC]"))
effects_CFL_pk_bchecks <- ggpredict(model_pk_bchecks, terms = c("knowledge_index", "BGU_group[CFL]"))
effects_CFC_pk_bchecks <- ggpredict(model_pk_bchecks, terms = c("knowledge_index", "BGU_group[CFC]"))

effects_pk_bchecks <- rbind(transform(effects_TL_pk_bchecks, treatment = "TL"),
                      transform(effects_TC_pk_bchecks, treatment = "TC"),
                      transform(effects_CFL_pk_bchecks, treatment = "CFL"),
                      transform(effects_CFC_pk_bchecks, treatment = "CFC"))

effects_pk_bchecks$treatment <- factor(effects_pk_bchecks$treatment, 
                                    levels = c("TL", "TC", "CFL", "CFC"), 
                                    labels = c("Trump Liberal", "Trump Conservative",
                                               "CF Liberal", "CF Conservative"))

# Subset the data for Trump 
trump_effects_pk_bchecks <- subset(effects_pk_bchecks, 
                                   treatment %in% c("Trump Liberal", "Trump Conservative"))

# Subset the data for Close Friend 
cf_effects_pk_bchecks <- subset(effects_pk_bchecks, treatment %in% c("CF Liberal", "CF Conservative"))

# Plot for Trump treatments
bchecks_plot_pk_trump <- ggplot(trump_effects_pk_bchecks, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Background Checks Policy Position", title = "Trump Treatments",
       x = "Political Knowledge",  color = "Treatment", fill = "Treatment") +
  theme_minimal() +
  theme(legend.position = "none")+
  scale_color_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

bchecks_plot_pk_trump

# Plot for Close Friend treatments
bchecks_plot_pk_cf <- ggplot(cf_effects_pk_bchecks, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Background Checks Policy Position", title = "Close Friend Treatments",
       x = "Political Knowledge", color = " ", fill = " ") +
  theme_minimal() +
  theme(legend.position = "none", axis.title.y = element_blank())  +
  scale_color_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

bchecks_plot_pk_cf

bchecks_plot_pk_final <- grid.arrange(bchecks_plot_pk_trump, bchecks_plot_pk_cf, 
                                      ncol = 2, widths = c(1.1, 1.0)) 

ggsave("bchecks_plot_polknowledge.png", bchecks_plot_pk_final, width = 6, height = 5, dpi = 600)
```

### Relevant interactions: Climate change

```{r}
model_pk_clima <- lm(climate ~ BGU_group * knowledge_index, data = data_wide)
effects_TL_pk_clima <- ggpredict(model_pk_clima, terms = c("knowledge_index", "BGU_group[TL]"))
effects_TC_pk_clima <- ggpredict(model_pk_clima, terms = c("knowledge_index", "BGU_group[TC]"))
effects_CFL_pk_clima <- ggpredict(model_pk_clima, terms = c("knowledge_index", "BGU_group[CFL]"))
effects_CFC_pk_clima <- ggpredict(model_pk_clima, terms = c("knowledge_index", "BGU_group[CFC]"))

effects_pk_clima <- rbind(transform(effects_TL_pk_clima, treatment = "TL"),
                      transform(effects_TC_pk_clima, treatment = "TC"),
                      transform(effects_CFL_pk_clima, treatment = "CFL"),
                      transform(effects_CFC_pk_clima, treatment = "CFC"))

effects_pk_clima$treatment <- factor(effects_pk_clima$treatment, 
                                    levels = c("TL", "TC", "CFL", "CFC"), 
                                    labels = c("Trump Liberal", "Trump Conservative",
                                               "CF Liberal", "CF Conservative"))

# Subset the data for Trump 
trump_effects_pk_clima <- subset(effects_pk_clima, 
                                   treatment %in% c("Trump Liberal", "Trump Conservative"))

# Subset the data for Close Friend 
cf_effects_pk_clima <- subset(effects_pk_clima, treatment %in% c("CF Liberal", "CF Conservative"))

# Plot for Trump treatments
clima_plot_pk_trump <- ggplot(trump_effects_pk_clima, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Climate Change Policy Position", title = "Trump Treatments",
       x = "Political Knowledge",  color = "Treatment", fill = "Treatment") +
  theme_minimal() +
  theme(legend.position = "none")+
  scale_color_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

clima_plot_pk_trump

# Plot for Close Friend treatments
clima_plot_pk_cf <- ggplot(cf_effects_pk_clima, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Climate Change Policy Position", title = "Close Friend Treatments",
       x = "Political Knowledge", color = " ", fill = " ") +
  theme_minimal() +
  theme(legend.position = "none", axis.title.y = element_blank())  +
  scale_color_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

clima_plot_pk_cf

clima_plot_pk_final <- grid.arrange(clima_plot_pk_trump, clima_plot_pk_cf, 
                                      ncol = 2, widths = c(1.1, 1.0)) 

ggsave("clima_plot_polknowledge.png", clima_plot_pk_final, width = 6, height = 5, dpi = 600)
```

Join the three plots

```{r}
polknowledge_interaction <- grid.arrange(guns_plot_pk_final,
                                         bchecks_plot_pk_final,
                                         clima_plot_pk_final,
                                         ncol = 1)

ggsave("polknowledge_inter.png", polknowledge_interaction, width = 6, height = 7, dpi = 600)
```


## Ideology interaction

```{r}
ideology_interaction <- list(
  "Wages" = lm(minimum_wage ~ BGU_group * ideology, data = data_wide),
  "Taxes" = lm(taxes ~ BGU_group * ideology, data = data_wide),
  "Abortion" = lm(abortion ~ BGU_group * ideology, data = data_wide),
  "Immigration" = lm(immigration ~ BGU_group * ideology, data = data_wide),
  "Guns" = lm(guns ~ BGU_group * ideology, data = data_wide),
  "Health Care" = lm(health ~ BGU_group * ideology, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group * ideology, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group * ideology, data = data_wide),
  "Planned Parenthood" = lm(p_parent ~ BGU_group * ideology, data = data_wide))

msummary(ideology_interaction,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = 'markdown')
```

## Party identification interaction

```{r}
party_id_interaction <- list(
  "Wages" = lm(minimum_wage ~ BGU_group * party_id, data = data_wide),
  "Taxes" = lm(taxes ~ BGU_group * party_id, data = data_wide),
  "Abortion" = lm(abortion ~ BGU_group * party_id, data = data_wide),
  "Immigration" = lm(immigration ~ BGU_group * party_id, data = data_wide),
  "Guns" = lm(guns ~ BGU_group * party_id, data = data_wide),
  "Health Care" = lm(health ~ BGU_group * party_id, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group * party_id, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group * party_id, data = data_wide),
  "Planned Parenthood" = lm(p_parent ~ BGU_group * party_id, data = data_wide))

party_id_interaction1 <- list(
  "Wages" = lm(minimum_wage ~ BGU_group * party_id, data = data_wide))

msummary(party_id_interaction1,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = 'latex')
```

### Wages and treatments

```{r}
model_wages_pid <- lm(minimum_wage ~ BGU_group * party_id, data = data_wide)
effects_TL_wages_pid <- ggpredict(model_wages_pid, terms = c("party_id", "BGU_group[TL]"))
effects_TC_wages_pid <- ggpredict(model_wages_pid, terms = c("party_id", "BGU_group[TC]"))
effects_CFL_wages_pid <- ggpredict(model_wages_pid, terms = c("party_id", "BGU_group[CFL]"))
effects_CFC_wages_pid <- ggpredict(model_wages_pid, terms = c("party_id", "BGU_group[CFC]"))

effects_wages_pid <- rbind(transform(effects_TL_wages_pid, treatment = "TL"),
                       transform(effects_TC_wages_pid, treatment = "TC"),
                       transform(effects_CFL_wages_pid, treatment = "CFL"),
                       transform(effects_CFC_wages_pid, treatment = "CFC"))

effects_wages_pid$treatment <- factor(effects_wages_pid$treatment, 
                                  levels = c("TL", "TC", "CFL", "CFC"), 
                                  labels = c("Trump Liberal", "Trump Conservative",
                                  "Close Friend Liberal", "Close Friend Conservative"))

wages_pid_plot <- ggplot(effects_wages_pid, aes(x = x, y = predicted)) +
  geom_point(aes(color = group), size = 3, position = position_dodge(width = 0.5)) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = group),
                width = 0.2, position = position_dodge(width = 0.5)) +
  labs(y = "Minimum Wages Policy Position", color = "Treatment") +  
  scale_x_discrete(labels=c("democrat" = "Democrat", 
                            "independent/other" = "Independent/Other", 
                            "republican" = "Republican")) + 
  theme_minimal() +
  theme(axis.title.x = element_blank(),
        legend.position = "bottom") +
  scale_y_continuous(limits = c(-0.5, NA))  +
  scale_color_manual(values = c("TL" = "#4C4C4C", "CFL" = "#A0A0A0", 
                                "TC" = "#787878", "CFC" = "#D0D0D0")) 


wages_pid_plot
```
I really like this plot and I think is a candidate to put in the paper. Although it's a little bit weird that the CF Liberal prompt makes people more conservative.

Have in mind that the phrasing of the question is the following: To increase the minimum wage to over 10 USD an hour. A close friend of yours has expressed support for this policy. How about you? Do you support or oppose increasing the minimum wage to over 10 USD an hour?


```{r}
ggsave("wages_party_id.png", wages_pid_plot, width = 4, height = 4, dpi = 300)
```


### Taxes and treatments

```{r}
model_taxes <- lm(taxes ~ BGU_group * party_id, data = data_wide)
effects_TL_taxes <- ggpredict(model_taxes, terms = c("party_id", "BGU_group[TL]"))
effects_TC_taxes <- ggpredict(model_taxes, terms = c("party_id", "BGU_group[TC]"))
effects_CFL_taxes <- ggpredict(model_taxes, terms = c("party_id", "BGU_group[CFL]"))
effects_CFC_taxes <- ggpredict(model_taxes, terms = c("party_id", "BGU_group[CFC]"))

effects_taxes <- rbind(transform(effects_TL_taxes, treatment = "TL"),
                       transform(effects_TC_taxes, treatment = "TC"),
                       transform(effects_CFL_taxes, treatment = "CFL"),
                       transform(effects_CFC_taxes, treatment = "CFC"))

effects_taxes$treatment <- factor(effects_taxes$treatment, 
                                  levels = c("TL", "TC", "CFL", "CFC"), 
                                  labels = c("Trump Liberal", "Trump Conservative",
                                  "Close Friend Liberal", "Close Friend Conservative"))

taxes_plot <- ggplot(effects_taxes, aes(x = x, y = predicted)) +
  geom_point(aes(color = group), size = 3, position = position_dodge(width = 0.5)) + 
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = group), 
                width = 0.2, position = position_dodge(width = 0.5)) +
  labs(y = "Taxes Policy Position", x = "Party Position") +
  theme_minimal() +
  theme(axis.title.x = element_text(size = 14))


taxes_plot
```

## Social conformism

Interaction between SCI and treatment

```{r}
sci_interaction <- list(
  "Wages" = lm(minimum_wage ~ BGU_group * SCI, data = data_wide),
  "Taxes" = lm(taxes ~ BGU_group * SCI, data = data_wide),
  "Abortion" = lm(abortion ~ BGU_group * SCI, data = data_wide),
  "Immigration" = lm(immigration ~ BGU_group * SCI, data = data_wide),
  "Guns" = lm(guns ~ BGU_group * SCI, data = data_wide),
  "Health Care" = lm(health ~ BGU_group * SCI, data = data_wide),
  "Background Checks" = lm(b_checks ~ BGU_group * SCI, data = data_wide),
  "Climate Change" = lm(climate ~ BGU_group * SCI, data = data_wide),
  "Planned Parenthood" = lm(p_parent ~ BGU_group * SCI, data = data_wide)
)

sci_interaction1 <- list(
  "Guns" = lm(guns ~ BGU_group * SCI, data = data_wide),
  "Health Care" = lm(health ~ BGU_group * SCI, data = data_wide))

msummary(sci_interaction1,
         stars = c('*' = .1, '**' = .05, '***' = .01),
         output = 'latex')
```

The interaction is only significative for the Trump prompt, for selected
models. Therefore, I'll only create interactions for selected models.

For BGU_groupTL × SCI, only wages For BGU_groupTC × SCI, only guns and
healthcare

### Treatment × SCI for wages

```{r}
model_wages <- lm(minimum_wage ~ BGU_group * SCI, data = data_wide)
effects_TL_wages <- ggpredict(model_wages, terms = c("SCI", "BGU_group[TL]"))
effects_TC_wages <- ggpredict(model_wages, terms = c("SCI", "BGU_group[TC]"))

effects_wages <- rbind(transform(effects_TL_wages, treatment = "TL"),
                       transform(effects_TC_wages, treatment = "TC"))

effects_wages$treatment <- factor(effects_wages$treatment, 
                                  levels = c("TC", "TL"), 
                                  labels = c("Conservative", "Liberal"))

wages_plot_sci <- ggplot(effects_wages, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1, show.legend = FALSE) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), 
              alpha = 0.2, show.legend = FALSE) +
  labs(y = "Wage Policy Position") +
  theme_minimal() +
  theme(axis.title.x = element_blank(),     
        axis.title.y = element_text(size = 14))     

wages_plot_sci
```

### Guns

```{r}
model_guns <- lm(guns ~ BGU_group * SCI, data = data_wide)
effects_TL_guns <- ggpredict(model_guns, terms = c("SCI", "BGU_group[TL]"))
effects_TC_guns <- ggpredict(model_guns, terms = c("SCI", "BGU_group[TC]"))
effects_CFL_guns <- ggpredict(model_guns, terms = c("SCI", "BGU_group[CFL]"))
effects_CFC_guns <- ggpredict(model_guns, terms = c("SCI", "BGU_group[CFC]"))

effects_guns <- rbind(transform(effects_TL_guns, treatment = "TL"),
                      transform(effects_TC_guns, treatment = "TC"),
                      transform(effects_CFL_guns, treatment = "CFL"),
                      transform(effects_CFC_guns, treatment = "CFC"))

effects_guns$treatment <- factor(effects_guns$treatment, 
                                  levels = c("TL", "TC", "CFL", "CFC"), 
                                  labels = c("Trump Liberal", "Trump Conservative",
                                             "CF Liberal", "CF Conservative"))

# Subset the data for Trump 
trump_effects_guns <- subset(effects_guns, treatment %in% c("Trump Liberal", "Trump Conservative"))

# Subset the data for Close Friend 
cf_effects_guns <- subset(effects_guns, treatment %in% c("CF Liberal", "CF Conservative"))

# Plot for Trump treatments
guns_plot_trump <- ggplot(trump_effects_guns, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Guns Policy Position", title = "Trump Treatments",
       x = "Social Conformism Index (SCI)",  color = "Treatment", fill = "Treatment") +
  theme_minimal() +
  theme(legend.position = "none")+
  scale_color_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

guns_plot_trump


# Plot for Close Friend treatments
guns_plot_cf <- ggplot(cf_effects_guns, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Guns Policy Position", title = "Close Friend Treatments",
       x = "Social Conformism Index (SCI)", color = " ", fill = " ") +
  theme_minimal() +
  theme(legend.position = "none", axis.title.y = element_blank())  +
  scale_color_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  scale_fill_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0")) +
  ylim(-1.5, 1.0)

guns_plot_cf

guns_plot_final <- grid.arrange(guns_plot_trump, guns_plot_cf, ncol = 2, widths = c(1.1, 1.0)) 

ggsave("guns_plot_final.png", guns_plot_final, width = 6, height = 5, dpi = 600)
```
This plot is also interesting, but note that -1 indicates the opposition to allowing teaching to carry guns, and 1 represents the support for it. So, in this case, people with lower levels of social conformisms are more in opposition to the policy, and people with higher levels of social conformism, more in favor of allowing teachers to carry guns. 

### Healthcare

```{r}
model_health <- lm(health ~ BGU_group * SCI, data = data_wide)
effects_TL_health <- ggpredict(model_health, terms = c("SCI", "BGU_group[TL]"))
effects_TC_health <- ggpredict(model_health, terms = c("SCI", "BGU_group[TC]"))
effects_CFL_health <- ggpredict(model_health, terms = c("SCI", "BGU_group[CFL]"))
effects_CFC_health <- ggpredict(model_health, terms = c("SCI", "BGU_group[CFC]"))


effects_health <- rbind(transform(effects_TL_health, treatment = "TL"),
                        transform(effects_TC_health, treatment = "TC"),
                        transform(effects_CFL_health, treatment = "CFL"),
                        transform(effects_CFC_health, treatment = "CFC"))

effects_health$treatment <- factor(effects_health$treatment, 
                                  levels = c("TL", "TC", "CFL", "CFC"), 
                                  labels = c("Trump Liberal", "Trump Conservative",
                                             "CF Liberal", "CF Conservative"))

# Subset the data for Trump 
trump_effects_health <- subset(effects_health, treatment %in% c("Trump Liberal", "Trump Conservative"))

# Subset the data for Close Friend 
cf_effects_health <- subset(effects_health, treatment %in% c("CF Liberal", "CF Conservative"))


# Plot for Trump treatments
health_plot_trump <- ggplot(trump_effects_health, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Health Policy Position",
       x = "Social Conformism Index (SCI)",  color = "Treatment", fill = "Treatment") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  scale_color_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0"),
                     labels = c("Trump\nLiberal", "Trump\nConservative")) +
  scale_fill_manual(values = c("Trump Liberal" = "black", "Trump Conservative" = "#A0A0A0"),
                    labels = c("Trump\nLiberal", "Trump\nConservative")) +
  scale_y_continuous(breaks = seq(-1, 1.5, by = 0.5), limits = c(-1.0, 1.5))
       
health_plot_trump 

# Plot for Close Friend treatments
health_plot_cf <- ggplot(cf_effects_health, aes(x = x, y = predicted, color = treatment)) +
  geom_line(aes(group = treatment), size = 1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = treatment), alpha = 0.2) +
  labs(y = "Health Policy Position",
       x = "Social Conformism Index (SCI)", color = "", fill = "") +
  theme_minimal() +
  theme(legend.position = "bottom", axis.title.y = element_blank()) +
  scale_color_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0"),
                     labels = c("Close Friend\nLiberal", "Close Friend\nConservative")) +
  scale_fill_manual(values = c("CF Liberal" = "black", "CF Conservative" = "#A0A0A0"),
                    labels = c("Close Friend\nLiberal", "Close Friend\nConservative")) +
  scale_y_continuous(breaks = seq(-1, 1.5, by = 0.5), limits = c(-1.0, 1.5))

health_plot_cf

# Combine the plots into one
health_plot_final <- grid.arrange(health_plot_trump, health_plot_cf, ncol = 2, widths = c(1.1, 1.0)) 

# Save the combined plot
ggsave("health_plot_final.png", health_plot_final, width = 6, height = 5, dpi = 600)
```

<!-- I also like this one --> 

Join the plots

```{r}
interaction_SCI <- grid.arrange(guns_plot_trump, guns_plot_cf, 
                                health_plot_trump, health_plot_cf,
                                ncol = 2, widths = c(1.1, 1.0)) 

ggsave("interaction_SCI.png", interaction_SCI, width = 6, height = 8, dpi = 600)
```
